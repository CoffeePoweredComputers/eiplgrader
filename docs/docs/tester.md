---
layout: default
title: Tester Module
nav_order: 3
---

# Tester Module

The `tester.py` file contains the `CodeTester` class and supporting classes, which are used to run unit tests on code generated by the `CodeGenerator`.

## Classes

### `CodeTestResult`

A simple, language-agnostic test result container that stores detailed information about test executions, including function calls, expected outputs, actual outputs, and pass/fail status for each test. No longer depends on unittest framework.

### `CodeTester`

This class provides a comprehensive interface for testing functions using predefined test cases.

#### Methods

- `__init__(code: Union[str, List[str]], test_cases: List[Dict[str, Any]], inplace: str = "0", function_name: str = "foo", language: str = "python")`
  - Initializes the tester with:
    - `code`: The code to be tested (single function or multiple function variants)
    - `test_cases`: List of test cases with parameters and expected outputs
    - `inplace`: Mode for handling in-place operations (options: "0", "1", "2")
    - `function_name`: Name of the function to test
    - `language`: Programming language for the code (default: "python")
  
- `run_tests(suppress_output: bool = False) -> Union[CodeTestResult, List[CodeTestResult]]`
  - Runs test cases against the provided code
  - Returns a single CodeTestResult or a list of results when testing multiple functions

## Test Case Format

Test cases must be provided as a list of dictionaries, each containing:

```python
{
    "parameters": {
        "param1": value1,
        "param2": value2,
        # ...
    },
    "expected": expected_result
}
```

## In-place Operation Modes

- `"0"`: Standard function that returns a value without modifying inputs
- `"1"`: Function that modifies its first argument in-place without returning a value
- `"2"`: Function that both modifies its first argument in-place and returns a value

## Multi-Language Support

The CodeTester now supports multiple programming languages through a unified architecture. Supported languages include:

- Python (default)
- JavaScript
- Java
- C
- C++
- Go
- Haskell

Each language has its own adapter and executor that handle language-specific compilation, execution, and testing requirements.

## Example Usage

### Testing a Single Function

```python
from eiplgrader.tester import CodeTester

code = """
def foo(a, b):
    return a + b
"""

test_cases = [
    {"parameters": {"a": 1, "b": 2}, "expected": 3},
    {"parameters": {"a": 5, "b": 7}, "expected": 12}
]

code_tester = CodeTester(code, test_cases)
test_result = code_tester.run_tests()
```

### Testing Multiple Function Variants

When testing multiple functions (e.g., from `num_to_gen > 1`), the tester automatically handles testing each variant:

```python
from eiplgrader.tester import CodeTester

code_variants = [
    "def foo(a, b):\n    return a + b",
    "def foo(a, b):\n    sum = a + b\n    return sum"
]

test_cases = [
    {"parameters": {"a": 1, "b": 2}, "expected": 3},
    {"parameters": {"a": 5, "b": 7}, "expected": 12}
]

code_tester = CodeTester(code_variants, test_cases)
test_results = code_tester.run_tests()  # Returns a list of results, one per variant
```

### Testing In-place Functions

For functions that modify their inputs in-place:

```python
from eiplgrader.tester import CodeTester

code = """
def foo(lst):
    lst.append(5)
"""

test_cases = [
    {"parameters": {"lst": [1, 2]}, "expected": [1, 2, 5]}
]

code_tester = CodeTester(code, test_cases, inplace="1")
test_result = code_tester.run_tests()
```

### Testing Code in Different Languages

```python
from eiplgrader.tester import CodeTester

# JavaScript example
javascript_code = """
function foo(a, b) {
    return a + b;
}
"""

test_cases = [
    {"parameters": {"a": 1, "b": 2}, "expected": 3},
    {"parameters": {"a": 5, "b": 7}, "expected": 12}
]

code_tester = CodeTester(javascript_code, test_cases, language="javascript")
test_result = code_tester.run_tests()
```

```python
# C++ example  
cpp_code = """
int foo(int a, int b) {
    return a + b;
}
"""

code_tester = CodeTester(cpp_code, test_cases, language="cpp")
test_result = code_tester.run_tests()
```
